#!/bin/zsh
# Wait for displays to settle after autorandr
sleep 1

# Laptop screen
PRIMARY=$(xrandr | grep " connected" | grep -i eDP | awk '{print $1}')

# First external monitor (not eDP)
EXT_MON=$(xrandr | grep " connected" | grep -v -i eDP | awk '{print $1}' | head -n1)

# Reload i3 to detect new outputs
i3-msg reload

if [ -n "$EXT_MON" ]; then
    echo "External monitor detected: $EXT_MON"
    
    # Move workspaces to correct outputs
    i3-msg "workspace 1; move workspace to output $PRIMARY"
    i3-msg "workspace 2; move workspace to output $EXT_MON"
    i3-msg "workspace 3; move workspace to output $EXT_MON"
    i3-msg "workspace 4; move workspace to output $EXT_MON"
else
    echo "Single monitor mode"
    
    # Move all workspaces back to laptop
    for ws in {1..10}; do
        i3-msg "workspace $ws; move workspace to output $PRIMARY"
    done
fi
